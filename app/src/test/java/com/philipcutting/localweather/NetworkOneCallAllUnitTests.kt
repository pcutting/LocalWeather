package com.philipcutting.localweather

import com.philipcutting.localweather.networking.OneCallApi
import com.philipcutting.localweather.networking.OneCallWeatherItem
import com.squareup.moshi.JsonAdapter
import com.squareup.moshi.Moshi
import org.junit.Assert
import org.junit.Test
import retrofit2.Retrofit
import retrofit2.converter.moshi.MoshiConverterFactory

class NetworkOneCallAllUnitTests {

    @Test
    fun `retrofit builds model and tests components`() {
        val retro = Retrofit.Builder()
            // something like: .baseData = testLocalJsonDataLong()
            .addConverterFactory(MoshiConverterFactory.create())
            .build()
            .create(OneCallApi::class.java)
        val weather = retro.getOneCallWeatherItems(testLocalJsonDataLong())

        Assert.assertTrue(weather.hourly.size >=4)
    }


    @Test
    fun `moshi parses into adapter class correctly correctly with few test points`() {
        val moshi = Moshi.Builder().build()
        val adapter : JsonAdapter<OneCallWeatherItem> = moshi.adapter(OneCallWeatherItem::class.java)
        val weatherData = adapter.fromJson(testLocalJsonDataLong())
        Assert.assertEquals(802, weatherData?.currentWeather?.weather?.first()?.id)
        Assert.assertTrue( weatherData?.hourlyWeathers?.size ?: 0  >= 5 )
    }
}

private fun testLocalJsonDataLong() :String {
    return """{"lat":42.6945,"lon":23.322,"timezone":"Europe/Sofia","timezone_offset":10800,"current":{"dt":1617605261,"sunrise":1617595314,"sunset":1617641790,"temp":37.4,"feels_like":30.79,"pressure":1015,"humidity":81,"dew_point":32.11,"uvi":1.47,"clouds":40,"visibility":10000,"wind_speed":9.22,"wind_deg":280,"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}]},"hourly":[{"dt":1617602400,"temp":37.4,"feels_like":33.84,"pressure":1015,"humidity":81,"dew_point":32.11,"uvi":0.68,"clouds":40,"visibility":10000,"wind_speed":4.52,"wind_deg":286,"wind_gust":8.03,"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"pop":0.12},{"dt":1617606000,"temp":37.69,"feels_like":33.35,"pressure":1016,"humidity":77,"dew_point":31.24,"uvi":1.47,"clouds":59,"visibility":10000,"wind_speed":5.53,"wind_deg":288,"wind_gust":7.74,"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"pop":0},{"dt":1617609600,"temp":39.4,"feels_like":35.98,"pressure":1017,"humidity":72,"dew_point":31.24,"uvi":2.52,"clouds":61,"visibility":10000,"wind_speed":4.74,"wind_deg":292,"wind_gust":5.59,"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"pop":0},{"dt":1617613200,"temp":41.49,"feels_like":38.75,"pressure":1017,"humidity":66,"dew_point":31.12,"uvi":3.5,"clouds":71,"visibility":10000,"wind_speed":4.32,"wind_deg":278,"wind_gust":4.81,"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"pop":0},{"dt":1617616800,"temp":43.77,"feels_like":41.77,"pressure":1016,"humidity":60,"dew_point":30.96,"uvi":4.22,"clouds":75,"visibility":10000,"wind_speed":3.89,"wind_deg":265,"wind_gust":4.41,"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"pop":0},{"dt":1617620400,"temp":45.84,"feels_like":44.38,"pressure":1015,"humidity":56,"dew_point":29.46,"uvi":4.19,"clouds":67,"visibility":10000,"wind_speed":3.62,"wind_deg":248,"wind_gust":4.25,"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"pop":0},{"dt":1617624000,"temp":47.25,"feels_like":46.13,"pressure":1014,"humidity":52,"dew_point":29.23,"uvi":3.56,"clouds":60,"visibility":10000,"wind_speed":3.47,"wind_deg":243,"wind_gust":4.65,"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"pop":0},{"dt":1617627600,"temp":48.25,"feels_like":47.64,"pressure":1013,"humidity":50,"dew_point":29.03,"uvi":2.97,"clouds":5,"visibility":10000,"wind_speed":3.06,"wind_deg":242,"wind_gust":5.1,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"pop":0},{"dt":1617631200,"temp":48.52,"feels_like":47.93,"pressure":1012,"humidity":49,"dew_point":28.78,"uvi":1.7,"clouds":4,"visibility":10000,"wind_speed":3.09,"wind_deg":232,"wind_gust":5.75,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"pop":0},{"dt":1617634800,"temp":48.29,"feels_like":48.29,"pressure":1011,"humidity":50,"dew_point":28.92,"uvi":0.72,"clouds":3,"visibility":10000,"wind_speed":2.46,"wind_deg":208,"wind_gust":5.28,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"pop":0},{"dt":1617638400,"temp":46.74,"feels_like":46.74,"pressure":1011,"humidity":60,"dew_point":32.04,"uvi":0.19,"clouds":3,"visibility":10000,"wind_speed":2.86,"wind_deg":147,"wind_gust":4.79,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"pop":0},{"dt":1617642000,"temp":42.01,"feels_like":39.94,"pressure":1011,"humidity":69,"dew_point":30.9,"uvi":0,"clouds":2,"visibility":10000,"wind_speed":3.67,"wind_deg":132,"wind_gust":4.52,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"pop":0},{"dt":1617645600,"temp":40.15,"feels_like":38.08,"pressure":1012,"humidity":72,"dew_point":30.38,"uvi":0,"clouds":2,"visibility":10000,"wind_speed":3.4,"wind_deg":127,"wind_gust":4.21,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"pop":0},{"dt":1617649200,"temp":39,"feels_like":36.95,"pressure":1012,"humidity":74,"dew_point":30,"uvi":0,"clouds":0,"visibility":10000,"wind_speed":3.24,"wind_deg":130,"wind_gust":4.18,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"pop":0},{"dt":1617652800,"temp":38.21,"feels_like":38.21,"pressure":1012,"humidity":76,"dew_point":29.73,"uvi":0,"clouds":0,"visibility":10000,"wind_speed":2.93,"wind_deg":137,"wind_gust":4.25,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"pop":0},{"dt":1617656400,"temp":37.38,"feels_like":37.38,"pressure":1012,"humidity":79,"dew_point":29.86,"uvi":0,"clouds":0,"visibility":10000,"wind_speed":2.86,"wind_deg":132,"wind_gust":4.27,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"pop":0},{"dt":1617660000,"temp":36.73,"feels_like":36.73,"pressure":1011,"humidity":81,"dew_point":29.86,"uvi":0,"clouds":1,"visibility":10000,"wind_speed":2.64,"wind_deg":131,"wind_gust":4.18,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"pop":0},{"dt":1617663600,"temp":36.19,"feels_like":36.19,"pressure":1011,"humidity":83,"dew_point":29.88,"uvi":0,"clouds":1,"visibility":10000,"wind_speed":2.3,"wind_deg":129,"wind_gust":4.03,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"pop":0},{"dt":1617667200,"temp":35.58,"feels_like":35.58,"pressure":1010,"humidity":85,"dew_point":29.97,"uvi":0,"clouds":1,"visibility":10000,"wind_speed":1.81,"wind_deg":132,"wind_gust":3.4,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"pop":0},{"dt":1617670800,"temp":35.17,"feels_like":35.17,"pressure":1010,"humidity":87,"dew_point":30.11,"uvi":0,"clouds":2,"visibility":10000,"wind_speed":1.43,"wind_deg":135,"wind_gust":2.98,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"pop":0},{"dt":1617674400,"temp":34.92,"feels_like":34.92,"pressure":1009,"humidity":89,"dew_point":30.4,"uvi":0,"clouds":4,"visibility":10000,"wind_speed":2.04,"wind_deg":131,"wind_gust":3.49,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"pop":0},{"dt":1617678000,"temp":34.75,"feels_like":34.75,"pressure":1009,"humidity":90,"dew_point":30.6,"uvi":0,"clouds":6,"visibility":10000,"wind_speed":1.63,"wind_deg":139,"wind_gust":2.91,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"pop":0},{"dt":1617681600,"temp":34.83,"feels_like":34.83,"pressure":1009,"humidity":92,"dew_point":31.01,"uvi":0,"clouds":8,"visibility":10000,"wind_speed":0.76,"wind_deg":168,"wind_gust":2.55,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"pop":0},{"dt":1617685200,"temp":36.97,"feels_like":36.97,"pressure":1008,"humidity":90,"dew_point":32.7,"uvi":0.22,"clouds":11,"visibility":10000,"wind_speed":0.31,"wind_deg":70,"wind_gust":2.93,"weather":[{"id":801,"main":"Clouds","description":"few clouds","icon":"02d"}],"pop":0},{"dt":1617688800,"temp":40.73,"feels_like":40.73,"pressure":1008,"humidity":84,"dew_point":34.63,"uvi":0.8,"clouds":14,"visibility":10000,"wind_speed":0.07,"wind_deg":178,"wind_gust":3.27,"weather":[{"id":801,"main":"Clouds","description":"few clouds","icon":"02d"}],"pop":0},{"dt":1617692400,"temp":44.46,"feels_like":44.46,"pressure":1007,"humidity":78,"dew_point":36.68,"uvi":1.91,"clouds":28,"visibility":10000,"wind_speed":0.63,"wind_deg":246,"wind_gust":4.61,"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"pop":0},{"dt":1617696000,"temp":48.18,"feels_like":48.18,"pressure":1005,"humidity":73,"dew_point":38.37,"uvi":3.28,"clouds":29,"visibility":10000,"wind_speed":1.57,"wind_deg":242,"wind_gust":5.95,"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"pop":0},{"dt":1617699600,"temp":51.51,"feels_like":49.51,"pressure":1004,"humidity":67,"dew_point":39.52,"uvi":4.55,"clouds":33,"visibility":10000,"wind_speed":1.68,"wind_deg":274,"wind_gust":6.38,"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"pop":0.01},{"dt":1617703200,"temp":54.19,"feels_like":52.27,"pressure":1003,"humidity":63,"dew_point":40.37,"uvi":4.37,"clouds":32,"visibility":10000,"wind_speed":1.86,"wind_deg":222,"wind_gust":6.62,"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"pop":0.03},{"dt":1617706800,"temp":55.2,"feels_like":53.29,"pressure":1002,"humidity":61,"dew_point":40.51,"uvi":4.35,"clouds":37,"visibility":10000,"wind_speed":1.07,"wind_deg":187,"wind_gust":5.35,"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"pop":0.11},{"dt":1617710400,"temp":55.8,"feels_like":53.89,"pressure":1001,"humidity":60,"dew_point":40.48,"uvi":3.69,"clouds":42,"visibility":10000,"wind_speed":3.49,"wind_deg":170,"wind_gust":6.22,"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"pop":0.16},{"dt":1617714000,"temp":56.17,"feels_like":54.32,"pressure":1000,"humidity":60,"dew_point":40.91,"uvi":1.25,"clouds":46,"visibility":10000,"wind_speed":5.06,"wind_deg":168,"wind_gust":7.18,"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"pop":0.38},{"dt":1617717600,"temp":54.7,"feels_like":52.92,"pressure":1000,"humidity":65,"dew_point":41.38,"uvi":0.72,"clouds":69,"visibility":10000,"wind_speed":4.9,"wind_deg":164,"wind_gust":6.6,"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10d"}],"pop":0.65,"rain":{"1h":0.22}},{"dt":1617721200,"temp":52.61,"feels_like":50.9,"pressure":1000,"humidity":71,"dew_point":42.06,"uvi":0.31,"clouds":79,"visibility":10000,"wind_speed":1.07,"wind_deg":177,"wind_gust":5.48,"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10d"}],"pop":0.61,"rain":{"1h":0.37}},{"dt":1617724800,"temp":50.56,"feels_like":48.97,"pressure":1001,"humidity":78,"dew_point":42.46,"uvi":0.13,"clouds":84,"visibility":10000,"wind_speed":1.88,"wind_deg":10,"wind_gust":5.57,"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10d"}],"pop":0.67,"rain":{"1h":0.15}},{"dt":1617728400,"temp":47.7,"feels_like":46.47,"pressure":1001,"humidity":81,"dew_point":40.6,"uvi":0,"clouds":83,"visibility":10000,"wind_speed":3.67,"wind_deg":355,"wind_gust":6.22,"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04n"}],"pop":0.73},{"dt":1617732000,"temp":46.45,"feels_like":44.46,"pressure":1002,"humidity":82,"dew_point":39.76,"uvi":0,"clouds":84,"visibility":10000,"wind_speed":4.41,"wind_deg":348,"wind_gust":6.46,"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04n"}],"pop":0.61},{"dt":1617735600,"temp":46.04,"feels_like":45.19,"pressure":1003,"humidity":83,"dew_point":39.72,"uvi":0,"clouds":99,"visibility":10000,"wind_speed":3,"wind_deg":356,"wind_gust":4.32,"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"pop":0},{"dt":1617739200,"temp":45.55,"feels_like":45.55,"pressure":1002,"humidity":84,"dew_point":39.4,"uvi":0,"clouds":99,"visibility":10000,"wind_speed":1.92,"wind_deg":353,"wind_gust":2.86,"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"pop":0},{"dt":1617742800,"temp":44.78,"feels_like":44.78,"pressure":1002,"humidity":84,"dew_point":38.73,"uvi":0,"clouds":100,"visibility":10000,"wind_speed":2.55,"wind_deg":324,"wind_gust":3.15,"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"pop":0},{"dt":1617746400,"temp":43.77,"feels_like":43.77,"pressure":1002,"humidity":84,"dew_point":37.89,"uvi":0,"clouds":100,"visibility":10000,"wind_speed":2.21,"wind_deg":316,"wind_gust":2.68,"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"pop":0},{"dt":1617750000,"temp":42.76,"feels_like":42.76,"pressure":1002,"humidity":86,"dew_point":37.17,"uvi":0,"clouds":97,"visibility":10000,"wind_speed":1.83,"wind_deg":298,"wind_gust":3.51,"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"pop":0},{"dt":1617753600,"temp":40.8,"feels_like":40.8,"pressure":1002,"humidity":88,"dew_point":35.87,"uvi":0,"clouds":92,"visibility":10000,"wind_speed":1.57,"wind_deg":288,"wind_gust":3.89,"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"pop":0.02},{"dt":1617757200,"temp":39.76,"feels_like":37.83,"pressure":1003,"humidity":87,"dew_point":34.68,"uvi":0,"clouds":26,"visibility":10000,"wind_speed":3.22,"wind_deg":309,"wind_gust":6.55,"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03n"}],"pop":0.11},{"dt":1617760800,"temp":38.48,"feels_like":35.67,"pressure":1002,"humidity":88,"dew_point":33.62,"uvi":0,"clouds":35,"visibility":10000,"wind_speed":3.89,"wind_deg":310,"wind_gust":4.59,"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03n"}],"pop":0.08},{"dt":1617764400,"temp":38.46,"feels_like":38.46,"pressure":1002,"humidity":87,"dew_point":33.57,"uvi":0,"clouds":50,"visibility":10000,"wind_speed":1.57,"wind_deg":292,"wind_gust":3.15,"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03n"}],"pop":0.11},{"dt":1617768000,"temp":38.75,"feels_like":36.16,"pressure":1003,"humidity":88,"dew_point":33.87,"uvi":0,"clouds":59,"visibility":10000,"wind_speed":3.71,"wind_deg":302,"wind_gust":7.81,"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"pop":0.25},{"dt":1617771600,"temp":39.45,"feels_like":34.88,"pressure":1003,"humidity":88,"dew_point":34.7,"uvi":0.08,"clouds":66,"visibility":10000,"wind_speed":6.33,"wind_deg":302,"wind_gust":12.55,"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10d"}],"pop":0.39,"rain":{"1h":0.14}}],"daily":[{"dt":1617616800,"sunrise":1617595314,"sunset":1617641790,"temp":{"day":43.77,"min":33.21,"max":48.52,"night":38.21,"eve":46.74,"morn":34.07},"feels_like":{"day":41.77,"night":29.84,"eve":46.74,"morn":29.84},"pressure":1016,"humidity":60,"dew_point":30.96,"wind_speed":3.89,"wind_deg":265,"weather":[{"id":600,"main":"Snow","description":"light snow","icon":"13d"}],"clouds":75,"pop":0.83,"snow":0.87,"uvi":4.22},{"dt":1617703200,"sunrise":1617681610,"sunset":1617728258,"temp":{"day":54.19,"min":34.75,"max":56.17,"night":45.55,"eve":50.56,"morn":34.83},"feels_like":{"day":52.27,"night":34.83,"eve":48.97,"morn":34.83},"pressure":1003,"humidity":63,"dew_point":40.37,"wind_speed":1.86,"wind_deg":222,"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10d"}],"clouds":32,"pop":0.73,"rain":0.74,"uvi":4.55},{"dt":1617789600,"sunrise":1617767908,"sunset":1617814727,"temp":{"day":35.56,"min":33.22,"max":44.78,"night":33.22,"eve":35.94,"morn":38.75},"feels_like":{"day":28.71,"night":36.16,"eve":28.54,"morn":36.16},"pressure":1009,"humidity":84,"dew_point":29.7,"wind_speed":8.88,"wind_deg":306,"weather":[{"id":616,"main":"Snow","description":"rain and snow","icon":"13d"}],"clouds":99,"pop":0.92,"rain":0.72,"snow":5.65,"uvi":5},{"dt":1617876000,"sunrise":1617854206,"sunset":1617901195,"temp":{"day":39.29,"min":26.44,"max":41.74,"night":33.71,"eve":41.74,"morn":26.44},"feels_like":{"day":31.12,"night":21.27,"eve":34.43,"morn":21.27},"pressure":1024,"humidity":58,"dew_point":24.08,"wind_speed":14.38,"wind_deg":296,"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"clouds":31,"pop":0.62,"uvi":4.42},{"dt":1617962400,"sunrise":1617940504,"sunset":1617987663,"temp":{"day":44.58,"min":30.56,"max":49.32,"night":40.21,"eve":49.24,"morn":30.56},"feels_like":{"day":44.58,"night":30.56,"eve":49.24,"morn":30.56},"pressure":1030,"humidity":51,"dew_point":25.92,"wind_speed":1.14,"wind_deg":333,"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"clouds":36,"pop":0,"uvi":5.34},{"dt":1618048800,"sunrise":1618026803,"sunset":1618074132,"temp":{"day":51.21,"min":35.22,"max":56.57,"night":46.49,"eve":56.05,"morn":35.22},"feels_like":{"day":48.42,"night":35.22,"eve":53.33,"morn":35.22},"pressure":1025,"humidity":51,"dew_point":32.25,"wind_speed":0.45,"wind_deg":133,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":1,"pop":0,"uvi":6},{"dt":1618135200,"sunrise":1618113102,"sunset":1618160600,"temp":{"day":55.18,"min":38.12,"max":61.34,"night":49.68,"eve":61.05,"morn":38.12},"feels_like":{"day":52.93,"night":38.12,"eve":58.96,"morn":38.12},"pressure":1025,"humidity":54,"dew_point":37.65,"wind_speed":1.97,"wind_deg":89,"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03d"}],"clouds":39,"pop":0,"uvi":6},{"dt":1618221600,"sunrise":1618199402,"sunset":1618247069,"temp":{"day":58.6,"min":41.86,"max":65.07,"night":51.91,"eve":63.45,"morn":41.86},"feels_like":{"day":56.75,"night":41.86,"eve":61.75,"morn":41.86},"pressure":1024,"humidity":55,"dew_point":41.18,"wind_speed":3.76,"wind_deg":88,"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":0,"pop":0,"uvi":6}]}"""
}